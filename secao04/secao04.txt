Seção 4: Desenvolvimento de aplicações Web Intermediário


21. O que vamos aprender nesta seção?


22. Controller tipados. Como construir um controller para um model.

Model
Quando desenvolvemos com ASP.Net MVC temos três elementos básicos, a Model, a View e o Controller.
Já vimos o que a camada Model pode fazer. Agora vamos ver como podemos passar informação para a View usando um Model ou melhor, um Viewmodel.



Quando trabalhamos com Views, podemos passar informação desde a Controller para a View para poder exibir essas informações.
Imagina ter um cadastro de clientes por exemplo. Um usuário poderia querer exibir o Id e o Nome de um cliente no navegador.


Como fazer no ASP.Net?

Primeiro modifica a Controller desta forma:
public ActionResult Details(int id) {
	var Cliente = ClasseDaCamadaModelCliente.BuscarPorID(id);
	return View(Cliente);
}


Para exibir isso na View:


@model MVC_.net_core.Models.Cliente
<div>
<h4>Cliente</h4>
<hr />
<dl class="row">
<dt class = "col-sm-2">
@Html.DisplayNameFor(model => model.id)
</dt>
<dd class = "col-sm-10">
@Html.DisplayFor(model => model.id)
</dd>
<dt class = "col-sm-2">
@Html.DisplayNameFor(model => model.nome)
</dt>
<dd class = "col-sm-10">
@Html.DisplayFor(model => model.nome)
</dd>
</dl>
</div>


Notem que há duas coisas importantes aqui, fazer o “import” do Model na View.

@model MVC_.net_core.Models.Cliente

E usar HTML Helpers para acessar e mostrar as propriedades da classe Cliente.

@Html.DisplayNameFor(model => model.id)
@Html.DisplayFor(model => model.id)

Lambdas são usadas no parametro do método helper




23. Extensibilidade de controllers.


ASP.Net Controllers

Um controller é uma classe. Como toda classe podemos criar extensões.

Ou seja, podemos criar nossos próprios Controllers com funções específicas.

Desta forma podemos reutilizar código usado numa controller.


Um exemplo disto é o envio de mensagens de informação, erro ou sucesso.

Com certeza esse tipo de mensagem será usada em toda parte no sistema.

Em lugar de repetir esse código, podemos criar um Controller do qual os outros Controllers do sistema possam herdar.

Lembram de herança?


Como se faz isto?
Podemos criar uma nova Controller vazia, sem métodos.

public class MeuControladorController : Controller{
public void Mensagem(string mensagem)
{}
}


Logo podemos fazer que os nossos Controllers herdem do MeuControlador no lugar de Controller:

public class ClienteController : MeuControladorController{ }


Bem simples, agora todo o código que esta no MeuControllador é acessível a Controller Cliente.

public class ClienteController : MeuControladorController{
public ActionResult Index()
{
Mensagem("Você esta na tela de index.");
return View(new List<Cliente>());
}
}


Para finalizar

Este é apenas um exemplo dos usos da extensibilidade de Controller.
Toda vez que um dado código se repete mais de uma vez num Controller, é provável que seja um candidato a estar num Controller de base.

Lembrar sempre que a Controller tem apenas a funcionalidade de intermediar entre a Model e as Views.

Evite colocar nos Controllers código de regras de negocio ou de acesso a dados.



24. Views (shared, partial). Trabalhando com um Viewmodel.

25. O que é Razor? Exemplo de uso.

26. Mapeamento Model->ViewModel

27. Model Binding.

28. Data annotations. Validação de dados.

29. Recapitulando